{"version":3,"sources":["webpack:///webpack/bootstrap b165f6d5ca61f775844a","webpack:///./~/babel-runtime/regenerator/index.js","webpack:///external \"fs\"","webpack:///external \"cheerio\"","webpack:///external \"request-promise\"","webpack:///./nuxt.config.js","webpack:///./server/middlwares/router.js","webpack:///external \"koa\"","webpack:///external \"koa-bodyparser\"","webpack:///external \"nuxt\"","webpack:///./server/controllers/heroHistory.js","webpack:///./server/cr/heroDetail.js","webpack:///./server/cr/heroList.js","webpack:///external \"iconv\"","webpack:///external \"koa-router\"","webpack:///external \"path\"","webpack:///external \"regenerator-runtime\"","webpack:///./server/index.js","webpack:///./server/config/word.js","webpack:///./server/controllers/word.js","webpack:///./server/cr/word-nav.js","webpack:///./server/cr/word.js","webpack:///./server/cr/wordDetail.js"],"names":["module","exports","head","title","meta","charset","name","content","hid","link","rel","type","href","css","loading","color","router","get","History","getHeroList","post","getHeroDetail","Word","getWordIndex","fetchWordNav","app","use","routes","allowedMethods","resolvePath","resolve","__dirname","url","ctx","next","isNew","query","filePath","exists","fs","existsSync","result","readFileSync","toString","JSON","parse","body","success","data","prams","request","id","console","log","HeroDetail","Iconv","require","iconv","getHeroDatail","_id","option","encoding","rp","then","convert","Buffer","cheerio","load","$","heroName","heroDetail","ht","hc","length","text","each","push","find","src","attr","hStr","replace","historyTitle","historyContent","writeFileSync","stringify","getHeroStory","options","uri","transform","navArr","heroList","hreodata","str","substr","r","filter","item","nav","host","process","env","HOST","port","PORT","config","dev","Server","useMiddleWares","bodyParser","nuxt","builder","build","catch","error","e","exit","status","Promise","reject","res","on","render","req","promise","listen","start","wordNavUrl","url1","url2","getWord","urlOpt","wordConfig","getWordNav","fetchWordDetail","contentUrl","getWordDetail","tofromData","typestr","main","sub","concat","time","idArr","match","img","textContent"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 16);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b165f6d5ca61f775844a","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/regenerator/index.js\n// module id = 0\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"cheerio\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cheerio\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"request-promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"request-promise\"\n// module id = 3\n// module chunks = 0","module.exports = {\n  /*\n   ** Headers of the page\n   */\n  head: {\n    title: 'starter',\n    meta: [\n      { charset: 'utf-8' },\n      { name: 'viewport', content: 'width=device-width, initial-scale=1' },\n      { hid: 'description', name: 'description', content: 'Nuxt.js project' }\n    ],\n    link: [\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' }\n    ]\n  },\n  /*\n   ** Global CSS\n   */\n  css: ['~static/css/main.css'],\n  /*\n   ** Customize the progress-bar color\n   */\n  loading: { color: '#3B8070' }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","/**\n * @file\n * @author 何文林\n * @date 2017/9/16\n */\nimport Router from 'koa-router'\nimport History from '../controllers/heroHistory'\nimport Word from '../controllers/word'\nconst router = app => {\n  const router = new Router()\n\n  // story\n  router.get('/api/history', History.getHeroList)\n  router.post('/api/heroDetail', History.getHeroDetail)\n\n  // word\n  router.get('/api/word', Word.getWordIndex)\n  router.get('/api/wordNav', Word.fetchWordNav)\n  router.get('/api/wordDetail', Word.fetchWordNav)\n\n  // 鉴赏\n  app.use(router.routes())\n  app.use(router.allowedMethods())\n}\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/middlwares/router.js","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"koa-bodyparser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-bodyparser\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 8\n// module chunks = 0","import History from '../cr/heroList'\nimport HeroDetail from '../cr/heroDetail'\nimport fs from 'fs'\nimport { resolve } from 'path'\n\nconst resolvePath = url => resolve(__dirname, url)\n\nconst getHeroList = async(ctx, next) => {\n  let isNew = ctx.query.isNew\n  let filePath = resolvePath('../crawerdb/heroList.json')\n  let exists = fs.existsSync(filePath)\n\n  let result = null\n\n  if (exists && !isNew) {\n    result = await fs.readFileSync(filePath)\n    result = result.toString()\n    result = JSON.parse(result)\n  } else {\n    result = await History()\n  }\n  ctx.body = {\n    success: true,\n    data: result\n  }\n}\n\nconst getHeroDetail = async(ctx, next) => {\n  let prams = ctx.request.body\n  let id = prams.id\n  let url = prams.url\n  let isNew = prams.isNew\n\n  let filePath = resolvePath('../crawerdb/herodetail' + id + '.json')\n  let exists = fs.existsSync(filePath)\n\n  let result = null\n\n  if (exists && !isNew) {\n    console.log(1)\n    result = await fs.readFileSync(filePath)\n    result = result.toString()\n    result = JSON.parse(result)\n  } else {\n    result = await HeroDetail(url, id)\n  }\n  ctx.body = {\n    success: true,\n    data: result\n  }\n}\n\nexport default {\n  getHeroList,\n  getHeroDetail\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/heroHistory.js","import rp from 'request-promise'\nimport cheerio from 'cheerio'\nimport { writeFileSync } from 'fs'\n\nconst Iconv = require('iconv').Iconv\n\nconst iconv = new Iconv('GBK', 'UTF-8')\n\nconst getHeroDatail = async(url, _id) => {\n  const option = {\n    encoding: null,\n    url\n  }\n\n  const $ = await rp(option).then(body => {\n    var result = iconv.convert(new Buffer(body, 'binary')).toString()\n    return cheerio.load(result)\n  })\n  let heroName = ''\n  let heroDetail = []\n  let ht = ''\n  let hc = ''\n  if ($('#heroStory').length) {\n    heroName = $('.hero_name pf').text()\n    $('#heroStory p').each(function () {\n      heroDetail.push($(this).text())\n    })\n  } else if ($('.textboxs').length) {\n    $('.textboxs p').each(function () {\n      if ($(this).find('img').length) {\n        let src = $(this).find('img').attr('src')\n        heroDetail.push({\n          type: 'img',\n          text: 'https:' + src\n        })\n      } else {\n        let text = $(this).text()\n        heroDetail.push({\n          type: 'text',\n          text: text\n        })\n      }\n    })\n  }\n  let hStr = ($('#history_content').text()).replace(/(^\\s+)|(\\s+$)/g, '');\n\n  if (hStr.length > 0) {\n    ht = $('.history_story h3').text()\n    hc = $('#history_content').text()\n  }\n  let result = {\n    heroName,\n    heroDetail,\n    historyTitle: ht,\n    historyContent: hc\n  }\n  writeFileSync('./server/crawerdb/herodetail' + _id + '.json', JSON.stringify(result, null, 2), 'utf-8')\n\n  return result\n}\n\nexport default getHeroDatail\n\n\n\n// WEBPACK FOOTER //\n// ./server/cr/heroDetail.js","import rp from 'request-promise'\nimport cheerio from 'cheerio'\nimport { writeFileSync } from 'fs'\n// request 国外网站的时候使用本地的 VPN\n// import Agent from 'socks5-http-client/lib/Agent'\n\nconst getHeroStory = async() => {\n  const options = {\n    uri: 'https://pvp.qq.com/act/a20160510story/herostory.htm',\n    // agentClass: Agent,\n    // agentOptions: {\n    //   socksHost: 'localhost',\n    //   socksPort: 1080 // 本地 VPN 的端口，这里用的 shadowsocks\n    // },\n    transform: body => cheerio.load(body)\n  }\n\n  const $ = await rp(options)\n  let navArr = []\n  let heroList = []\n  $('#campNav li').each(function () {\n    const type = $(this).attr('data-camptype')\n    const text = $(this).find('a').text()\n    navArr.push({ type, text })\n  })\n\n  const hreodata = await rp({\n    uri: 'https://pvp.qq.com/webplat/info/news_version3/15592/18024/23901/24397/24398/m17330/list_1.shtml'\n  })\n  let str = hreodata.replace('createHeroList(', '')\n  str = str.substr(0, str.length - 1)\n  let r = JSON.parse(str)\n  heroList = r.data.filter(item => item)\n\n  let result = {\n    nav: navArr,\n    heroList\n  }\n  writeFileSync('./server/crawerdb/heroList.json', JSON.stringify(result, null, 2), 'utf-8')\n\n  return result\n}\n\nexport default getHeroStory\n\n\n\n// WEBPACK FOOTER //\n// ./server/cr/heroList.js","module.exports = require(\"iconv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"iconv\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 15\n// module chunks = 0","import Koa from 'koa'\nimport { Nuxt, Builder } from 'nuxt'\nimport bodyParser from 'koa-bodyparser'\nimport router from './middlwares/router'\n\nconst host = process.env.HOST || '127.0.0.1'\nconst port = process.env.PORT || 5009\n\n// Import and Set Nuxt.js options\nlet config = require('../nuxt.config.js')\nconfig.dev = !(process.env === 'production')\n\nclass Server {\n  constructor() {\n    this.app = new Koa()\n    this.useMiddleWares(this.app)\n  }\n  useMiddleWares(app) {\n    app.use(bodyParser())\n    router(app)\n  }\n  start() {\n    // Instantiate nuxt.js\n    const nuxt = new Nuxt(config)\n\n    // Build in development\n    if (config.dev) {\n      const builder = new Builder(nuxt)\n      builder.build().catch(e => {\n        console.error(e) // eslint-disable-line no-console\n        process.exit(1)\n      })\n    }\n\n    this.app.use(ctx => {\n      ctx.status = 200 // koa defaults to 404 when it sees that status is unset\n\n      return new Promise((resolve, reject) => {\n        ctx.res.on('close', resolve)\n        ctx.res.on('finish', resolve)\n        nuxt.render(ctx.req, ctx.res, promise => {\n          // nuxt.render passes a rejected promise into callback on error.\n          promise.then(resolve).catch(reject)\n        })\n      })\n    })\n\n    this.app.listen(port, host)\n    console.log('Server listening on ' + host + ':' + port) // eslint-disable-line no-console\n  }\n}\n\nconst app = new Server()\napp.start()\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js","const wordNavUrl = {\n  '482175': {\n    url1: 'https://pvp.qq.com//webplat/info/news_version3/15592/18024/23901/24878/24883/24901/m15567/list_1.shtml',\n    url2: 'https://pvp.qq.com//webplat/info/news_version3/15592/18024/23901/24878/24883/24902/m15565/list_1.shtml'\n  },\n  '482168': {\n    url1: 'https://pvp.qq.com//webplat/info/news_version3/15592/18024/23901/24878/24882/24899/m15567/list_1.shtml',\n    url2: 'https://pvp.qq.com//webplat/info/news_version3/15592/18024/23901/24878/24882/24900/m15565/list_1.shtml'\n  },\n  '482154': {\n    url1: 'https://pvp.qq.com//webplat/info/news_version3/15592/18024/23901/24878/24881/24897/m15567/list_1.shtml',\n    url2: 'https://pvp.qq.com//webplat/info/news_version3/15592/18024/23901/24878/24881/24898/m15565/list_1.shtml'\n  },\n  '482143': {\n    url1: 'https://pvp.qq.com//webplat/info/news_version3/15592/18024/23901/24878/24880/24895/m15567/list_1.shtml',\n    url2: 'https://pvp.qq.com//webplat/info/news_version3/15592/18024/23901/24878/24880/24896/m15565/list_1.shtml'\n  },\n  '482129': {\n    url1: 'https://pvp.qq.com//webplat/info/news_version3/15592/18024/23901/24878/24879/24893/m15567/list_1.shtml',\n    url2: 'https://pvp.qq.com//webplat/info/news_version3/15592/18024/23901/24878/24879/24894/m15565/list_1.shtml'\n  }\n}\n\nexport default wordNavUrl\n\n\n\n// WEBPACK FOOTER //\n// ./server/config/word.js","import fs from 'fs'\nimport { resolve } from 'path'\nimport getWord from '../cr/word'\nimport getWordNav from '../cr/word-nav'\nimport getWordDetail from '../cr/wordDetail'\nimport wordConfig from '../config/word'\n\nconst resolvePath = url => resolve(__dirname, url)\n\n// 获取世界首页数据\nconst getWordIndex = async(ctx, next) => {\n  let isNew = ctx.query.isNew\n  let id = ctx.query.id // word id\n\n  let filePath = resolvePath('../crawerdb/wordnav' + id + '.json')\n  let exists = fs.existsSync(filePath)\n\n  let result = null\n\n  if (exists && !isNew) {\n    result = await fs.readFileSync(filePath)\n    result = result.toString()\n    result = JSON.parse(result)\n  } else {\n    result = await getWord()\n  }\n  ctx.body = {\n    success: true,\n    data: result\n  }\n}\n\n// 获取某个世界的顶部导航\nconst fetchWordNav = async(ctx, next) => {\n  let isNew = ctx.query.isNew\n  let id = ctx.query.id // word id\n  let urlOpt = wordConfig[id]\n\n  let filePath = resolvePath('../crawerdb/wordnav' + id + '.json')\n  let exists = fs.existsSync(filePath)\n\n  let result = null\n\n  if (exists && !isNew) {\n    result = await fs.readFileSync(filePath)\n    result = result.toString()\n    result = JSON.parse(result)\n  } else {\n    result = await getWordNav(urlOpt.url1, urlOpt.url2)\n  }\n  ctx.body = {\n    success: true,\n    data: result\n  }\n}\n\n// 获取某个世界内容\nconst fetchWordDetail = async(ctx, next) => {\n  let isNew = ctx.query.isNew\n  let id = ctx.request.id // word id\n  let contentUrl = ctx.request.url // 某个世界导航下面的内容\n\n  let filePath = resolvePath('../crawerdb/worddetail' + id + '.json')\n  let exists = fs.existsSync(filePath)\n\n  let result = null\n\n  if (exists && !isNew) {\n    result = await fs.readFileSync(filePath)\n    result = result.toString()\n    result = JSON.parse(result)\n  } else {\n    result = await getWordDetail(contentUrl, id)\n  }\n  ctx.body = {\n    success: true,\n    data: result\n  }\n}\n\nexport default {\n  getWordIndex,\n  fetchWordNav,\n  fetchWordDetail\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/word.js","import rp from 'request-promise'\n// import cheerio from 'cheerio'\n\nimport { writeFileSync } from 'fs'\n\nconst Iconv = require('iconv').Iconv\n\nconst iconv = new Iconv('GBK', 'UTF-8')\n\nfunction tofromData(str, typestr) {\n  str = str.replace(typestr, '')\n  str = str.substr(0, str.length - 1)\n  let data = JSON.parse(str)\n  return data.data.filter(item => item)\n}\n\nexport const getWordNav = async(url1, url2, id) => {\n  let main = await rp({\n    encoding: null,\n    uri: url1\n  }).then(body => {\n    let result = iconv.convert(new Buffer(body, 'binary')).toString()\n    return result\n  })\n\n  main = tofromData(main, 'jsonpCallfnBtn(')\n\n  let sub = await rp({\n    encoding: null,\n    uri: url2\n  }).then(body => {\n    let result = iconv.convert(new Buffer(body, 'binary')).toString()\n    return result\n  })\n\n  sub = tofromData(sub, 'jsonpCallfn(')\n\n  let result = main.concat(sub)\n\n  writeFileSync('./crawerdb/wordnav' + id + '.json', JSON.stringify(result, null, 2), 'utf-8')\n  return result\n}\n\nexport default getWordNav\n\n\n\n// WEBPACK FOOTER //\n// ./server/cr/word-nav.js","import rp from 'request-promise'\nimport cheerio from 'cheerio'\nimport { writeFileSync } from 'fs'\n\nconst getWord = async() => {\n  const options = {\n    uri: 'https://pvp.qq.com/act/a20160510story/origin.htm',\n    transform: body => cheerio.load(body)\n  }\n  const $ = await rp(options)\n\n  let result = []\n  $('.cell_box .cell_left, .cell_right').each(function () {\n    let time = $(this).find('.cell_title').text()\n    let url = $(this).find('a').attr('href')\n    let idArr = url.match(/\\/(\\d+).shtml/)\n    let id = idArr[1]\n    let title = $(this).find('a').attr('title')\n    let img = $(this).find('img').attr('src')\n    result.push({\n      time,\n      url,\n      id,\n      title,\n      img\n    })\n  })\n  writeFileSync('./server/crawerdb/word.json', JSON.stringify(result, null, 2), 'utf-8')\n  return result\n}\n\nexport default getWord\n\n\n\n// WEBPACK FOOTER //\n// ./server/cr/word.js","import rp from 'request-promise'\nimport cheerio from 'cheerio'\nimport { writeFileSync } from 'fs'\nconst Iconv = require('iconv').Iconv\n\nconst iconv = new Iconv('GBK', 'UTF-8')\n\nexport const fetchWordDetail = async(url, id) => {\n  const options = {\n    encoding: null,\n    uri: url\n  }\n  const $ = await rp(options).then(body => {\n    var result = iconv.convert(new Buffer(body, 'binary')).toString()\n    return cheerio.load(result)\n  })\n\n  let title = $('.txtbox h2').text()\n  let time = $('.txtbox .time').text() || ''\n  let textContent = []\n  $('.txtcon p').each(function () {\n    textContent.push($(this).text())\n  })\n\n  let result = {\n    title,\n    time,\n    textContent\n  }\n  writeFileSync('./server/crawerdb/worddetail' + id + '.json', JSON.stringify(result, null, 2), 'utf-8')\n  return result\n}\n\nexport default fetchWordDetail\n\n\n\n// WEBPACK FOOTER //\n// ./server/cr/wordDetail.js"],"sourceRoot":""}